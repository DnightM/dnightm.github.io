(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{1470:function(e,t,r){"use strict";r.r(t);r(29),r(13),r(17),r(51),r(32),r(53),r(43),r(28),r(34),r(56),r(57),r(47);var n=r(14),o=r(7),c=r(8),l=r(10),h=r(9),f=r(6),d=(r(39),r(103),r(3)),v=r(1),m=r(18),x=r(419);function y(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(h.a)(this,r)}}var w=function(e){Object(l.a)(d,e);var t,r,h,f=k(d);function d(){var e;return Object(o.a)(this,d),(e=f.apply(this,arguments)).PopupStore=Object(v.getModule)(m.default,e.$store),e.UploadStore=Object(v.getModule)(x.default,e.$store),e.watermarkRemoved=!1,e.activeIndex=0,e.viewCashAlert=!1,e.viewCouponAlert=!1,e.name="",e.cash="",e.phoneNumber="",e.coupon="",e.max=90,e.current=0,e.interval=null,e}return Object(c.a)(d,[{key:"onChangePopup",value:function(){this.viewCashAlert=!1,this.viewCouponAlert=!1}},{key:"runningPercentage",get:function(){return this.current/this.max*100}},{key:"active",value:function(e){this.activeIndex=e}},{key:"paymentType",get:function(){return 0===this.activeIndex?"CASH":"COUPON"}},{key:"popup",get:function(){return this.PopupStore.purchaseRequestPopup},set:function(e){this.PopupStore.setPurchaseRequestPopup(e)}},{key:"waterMarkItem",get:function(){return this.PopupStore.waterMarkItem}},{key:"purchaseType",get:function(){return this.PopupStore.purchaseType},set:function(e){this.PopupStore.setPurchaseType(e)}},{key:"alertPopup",get:function(){return this.PopupStore.alertPopup},set:function(e){this.PopupStore.toggleAlertPopup(e)}},{key:"purchaseInProgress",get:function(){return this.UploadStore.purchaseInProgress},set:function(e){this.UploadStore.setPurchaseInProgress(e)}},{key:"cleanWaterMarkItem",value:function(){this.PopupStore.setWaterMarkItem(null)}},{key:"purchaseRequestText",get:function(){switch(this.purchaseType){case"FINAL_VIDEO":return"최종 영상 요청";case"WATERMARK":return"워터마크 제거 요청";default:return null}}},{key:"purchaseWaitingPopup",get:function(){return this.PopupStore.purchaseWaitingPopup},set:function(e){this.PopupStore.setPurchaseWaitingPopup(e)}},{key:"urls",get:function(){return this.PopupStore.purchaseURLs}},{key:"initLoadingInterval",value:function(){var e=this;this.current=0,this.interval&&clearInterval(this.interval),this.interval=setInterval((function(){e.current+.2<=e.max&&(e.current+=.2),e.current>99.59&&e.current<100&&(e.current=100)}),100)}},{key:"requestRemoveWatermark",value:(h=Object(n.a)(regeneratorRuntime.mark((function e(){var t,body,r,n,o,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.waterMarkItem,body={extend:"1y"},0===this.activeIndex?(body.name=this.name,body.phoneNumber=this.phoneNumber):body.coupon=this.coupon,this.PopupStore.setPurchaseLoadingPercentage(0),this.activeIndex,this.purchaseInProgress=!0,this.initLoadingInterval(),e.next=9,this.$axios.$patch("/payments/watermark/".concat(t.id),body);case 9:if(!e.sent.expiredDate){e.next=22;break}return this.cleanWaterMarkItem(),this.PopupStore.setWatermarkRemoved(!0),e.next=15,this.$axios.$get("/uploads");case 15:r=e.sent,n=y(r);try{for(n.s();!(o=n.n()).done;)(c=o.value).expand=!1,c.hamburger=!1,8===(l=c.options).selectedBodyHTMLId?c.thumbnail="https://cdn2.makedear.com/homepage/img/upload/main9.jpg":c.thumbnail=l.image.url||"https://cdn2.makedear.com/homepage/img/upload/no-thumb.jpg"}catch(e){n.e(e)}finally{n.f()}this.UploadStore.setUploads(r),this.popup=!1,e.next=24;break;case 22:"COUPON"===this.paymentType&&(this.viewCouponAlert=!0),"CASH"===this.paymentType&&(this.viewCashAlert=!0);case 24:this.purchaseInProgress=!1;case 25:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"requestFinalVideo",value:(r=Object(n.a)(regeneratorRuntime.mark((function e(){var t,body;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.waterMarkItem,body={extend:"1y"},0===this.activeIndex?body.cash=this.cash:body.coupon=this.coupon,e.next=5,this.$axios.$patch("/payments/final-video/".concat(t.id),body);case 5:e.sent.expiredDate?(alert("결제가 확인되었습니다."),this.alertPopup=!0,this.PopupStore.setAlertPopupText("결제가 확인되었습니다.")):("COUPON"===this.paymentType&&(this.viewCouponAlert=!0),"CASH"===this.paymentType&&(this.viewCashAlert=!0));case 7:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"checkPurchase",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.purchaseInProgress&&alert("결제 확인중입니다."),e.t0=this.purchaseType,e.next="WATERMARK"===e.t0?4:"FINAL_VIDEO"===e.t0?7:9;break;case 4:return e.next=6,this.requestRemoveWatermark();case 6:return e.abrupt("break",9);case 7:return e.next=9,this.requestFinalVideo();case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"goToStore",value:function(e){this.PopupStore.setPurchaseURL(e),this.PopupStore.setLinkToStorePopup(!0)}},{key:"close",value:function(){this.cleanWaterMarkItem(),this.popup=!1}}]),d}(v.Vue);Object(d.a)([Object(v.Watch)("popup")],w.prototype,"onChangePopup",null);var C=w=Object(d.a)([v.Component],w),_=r(12),component=Object(_.a)(C,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("Popup",{attrs:{permenant:""},model:{value:e.popup,callback:function(t){e.popup=t},expression:"popup"}},[t("div",{staticClass:"relative flex flex-col items-center bg-white rounded-xl"},[t("div",{staticClass:"p-12 w-full"},[t("div",{staticClass:"flex w-full"},[t("div",{staticClass:"px-8 py-4 bg-[#f9f9f9] rounded-t-lg border border-[#ccc] border-b-0 border-r-0 cursor-pointer",class:{"!bg-white overflow-hidden":0===e.activeIndex},on:{click:function(t){return e.active(0)}}},[e._v("\n          결제\n        ")]),e._v(" "),t("div",{staticClass:"ml-[-1px] px-8 py-4 bg-[#f9f9f9] rounded-t-lg border border-[#ccc] border-b-0 cursor-pointer",class:{"!bg-white overflow-hidden":1===e.activeIndex},on:{click:function(t){return e.active(1)}}},[e._v("\n          쿠폰\n        ")])]),e._v(" "),t("div",{staticClass:"mb-4 mt-[-1px] w-full h-[1px] bg-[#eee]"}),e._v(" "),0===e.activeIndex?t("div",{staticClass:"flex flex-col"},[t("div",{staticClass:"mt-4 p-6 flex flex-col items-center w-full bg-[#f9f9f9] rounded-lg text-center leading-10"},[e._v("\n          결제하지 않으셨다면\n          "),t("br"),e._v("\n          아래 '결제하기'를 눌러 결제해 주세요.\n          "),e._l(e.urls,(function(r){return t("button",{key:r,staticClass:"mt-4 px-4 py-2 flex justify-center items-center bg-[#54d058] rounded-md text-white",on:{click:function(t){return e.goToStore(r)}}},[e._v("\n            결제하기\n          ")])}))],2),e._v(" "),t("div",{staticClass:"mt-4 p-6 flex flex-col items-center w-full bg-[#f9f9f9] rounded-lg text-center leading-10"},[e._v("\n          결제하셨는데 확인이 안되시거나\n          "),t("br"),e._v("\n          또는 다른 아이디로 결제하셨다면\n          "),t("br"),e._v("\n          결제하신 이름과 전화번호를 입력해 주세요.\n          "),t("div",{staticClass:"mt-4 gap-4 flex flex-col items-end"},[t("div",{staticClass:"flex items-center justify-center"},[t("span",{staticClass:"mr-2"},[e._v("이름 : ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.name,expression:"name"}],staticClass:"mr-3 px-4 w-56 h-16 rounded-md border border-[#ccc] text-[#000000]",domProps:{value:e.name},on:{input:function(t){t.target.composing||(e.name=t.target.value)}}})]),e._v(" "),t("div",{staticClass:"flex items-center justify-center"},[t("span",{staticClass:"mr-2"},[e._v("전화번호 : ")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.phoneNumber,expression:"phoneNumber"}],staticClass:"mr-3 px-4 w-56 h-16 rounded-md border border-[#ccc] text-[#000000]",domProps:{value:e.phoneNumber},on:{input:function(t){t.target.composing||(e.phoneNumber=t.target.value)}}})])]),e._v(" "),e.viewCashAlert?t("span",{staticClass:"mt-4 text-[#ff0000]"},[e._v("* 결제 내역을 찾을 수 없습니다.")]):e._e()])]):t("div",[t("div",{staticClass:"p-6 flex flex-col w-full text-center bg-[#f9f9f9] rounded-lg"},[e._v("\n          쿠폰 번호를 입력해 주세요.\n          "),t("div",{staticClass:"mt-4 flex items-center justify-center"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.coupon,expression:"coupon"}],staticClass:"px-4 w-56 h-16 rounded-md border border-[#ccc] text-[#000000]",domProps:{value:e.coupon},on:{input:function(t){t.target.composing||(e.coupon=t.target.value)}}})]),e._v(" "),e.viewCouponAlert?t("span",{staticClass:"mt-4 text-[#ff0000]"},[e._v("* 쿠폰이 유효하지 않습니다.")]):e._e()])])]),e._v(" "),t("div",{staticClass:"flex w-full"},[t("button",{staticClass:"modalbtn-l",on:{click:e.close}},[e._v("\n        닫기\n      ")]),e._v(" "),t("button",{staticClass:"modalbtn-r",on:{click:e.checkPurchase}},[e._v("\n        "+e._s(e.purchaseRequestText)+"\n      ")])])])])}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Popup:r(54).default})}}]);