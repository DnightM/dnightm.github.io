(window.webpackJsonp=window.webpackJsonp||[]).push([[170],{1278:function(t,e,n){"use strict";(function(t){n(13),n(17),n(51),n(32),n(53),n(43),n(34),n(56),n(57),n(47);var o=n(14),r=n(7),c=n(8),l=n(10),f=n(9),d=n(6),v=(n(39),n(28),n(212),n(29),n(223),n(3)),h=n(1),m=n(730),y=n(1440),C=n.n(y),_=n(1441),w=n(15),x=n(18),k=n(211),S=n(38);function O(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return P(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,c=!0,l=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return c=t.done,t},e:function(t){l=!0,r=t},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw r}}}}function P(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function j(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,o=Object(d.a)(t);if(e){var r=Object(d.a)(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Object(f.a)(this,n)}}var A=function(e){Object(l.a)(v,e);var n,f,d=j(v);function v(){var t;return Object(r.a)(this,v),(t=d.apply(this,arguments)).MainStore=Object(h.getModule)(w.default,t.$store),t.PopupStore=Object(h.getModule)(x.default,t.$store),t.AdminStore=Object(h.getModule)(k.default,t.$store),t.AuthStore=Object(h.getModule)(S.default,t.$store),t}return Object(c.a)(v,[{key:"popup",get:function(){return this.PopupStore.imageCardCheckDownloadPopup},set:function(t){this.PopupStore.toggleImageCardCheckDownloadPopup(t)}},{key:"code",get:function(){return this.$route.params.id}},{key:"editor",get:function(){return this.MainStore.editor}},{key:"orderInfo",get:function(){return this.MainStore.info}},{key:"imageDownloadCount",get:function(){return this.MainStore.imageDownloadCount}},{key:"imageType",get:function(){return this.PopupStore.imageCardPopupType}},{key:"close",value:function(){this.popup=!1}},{key:"imageName",get:function(){switch(this.imageType){case"thanksletter":return"감사장";case"SEND":return"메인 이미지";case"SNS":return"이미지 초대장(SNS)";case"kakaotalk":return"카카오톡 배경화면"}}},{key:"checkUserAgent",value:function(){if(!t.navigator)return"";if(/iphone|ipad|ipod|android/i.test(t.navigator.userAgent.toLowerCase())){var e=t.navigator.userAgent.toLowerCase();return e.search("android")>-1?"android":e.search("iphone")>-1||e.search("ipod")>-1||e.search("ipad")>-1?"ios":"other"}return"pc"}},{key:"downloadZip",value:(f=Object(o.a)(regeneratorRuntime.mark((function t(e){var n,o,r,c,l,f,body,content;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=new C.a,o=O(e);try{for(o.s();!(r=o.n()).done;)c=r.value,l="".concat(Object(m.a)(12),".png"),f=c.indexOf("base64,")+7,body=c.substring(f),n.file(l,body,{base64:!0})}catch(t){o.e(t)}finally{o.f()}return content=null,t.prev=4,t.next=7,n.generateAsync({type:"blob"});case 7:content=t.sent,t.next=13;break;case 10:t.prev=10,t.t0=t.catch(4),console.log(t.t0);case 13:content?(console.log("content exist"),Object(_.saveAs)(content,"image-card.zip")):console.log("content not exist");case 14:case"end":return t.stop()}}),t,null,[[4,10]])}))),function(t){return f.apply(this,arguments)})},{key:"downloadImage",value:(n=Object(o.a)(regeneratorRuntime.mark((function t(){var e,n,o,r,c,l,f,d,v,h,y,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.imageDownloadCount["".concat(this.imageType,"Max")],!(this.imageDownloadCount["".concat(this.imageType)]>=n)||this.AdminStore.loggedIn){t.next=6;break}return this.popup=!1,this.PopupStore.toggleImageCardCannotDownloadPopup(!0),t.abrupt("return");case 6:if(t.prev=6,this.popup=!1,o=this.imageType,this.PopupStore.toggleCardDownloadPopup(!0),this.PopupStore.setCardDownloadType(o),r=null===(e=this.AuthStore)||void 0===e?void 0:e.privateUserInfo,c=(null==r?void 0:r.name)||"",l=(null==r?void 0:r.phone)||"",f=(null==r?void 0:r.email)||"",console.log(r," userinfo"),!(c&&l&&f)){t.next=19;break}return t.next=19,this.$axios.$post("/invitation",{options:this.MainStore.editor,code:this.$route.query.code,clientName:c,phoneNumber:l,email:f,isImageCard:!0});case 19:return t.next=21,this.$axios.$post("/image/capture/image-card",{code:this.$route.query.code,orderId:this.orderInfo.orderId,imageType:o,isAdmin:this.AdminStore.loggedIn});case 21:d=t.sent,v=d.images,this.PopupStore.toggleCardDownloadPopup(!1),h=v.at(0),y="".concat(Object(m.a)(12),".png"),(a=document.createElement("a")).href=h,a.download=y,a.click(),this.MainStore.setImageDownloadCount(d.imageDownloadCount),this.PopupStore.toggleImageCardCompleteDownloadPopup(!0),t.next=37;break;case 34:t.prev=34,t.t0=t.catch(6),console.log(t.t0,"error");case 37:case"end":return t.stop()}}),t,this,[[6,34]])}))),function(){return n.apply(this,arguments)})}]),v}(h.Vue);A=Object(v.a)([h.Component],A),e.a=A}).call(this,n(82))},1530:function(t,e,n){"use strict";n.r(e);var o=n(1278).a,r=n(12),component=Object(r.a)(o,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("Popup",{staticClass:"z-[10000001]",model:{value:t.popup,callback:function(e){t.popup=e},expression:"popup"}},[e("div",{staticClass:"flex flex-col items-center bg-white rounded-xl"},[e("div",{staticClass:"p-12 w-full rounded-t-xl text-center leading-10"},[t._v("\n      "+t._s(t.imageName)+"을 다운로드 하시겠습니까?\n      "),e("br"),t._v("\n      다운로드 가능 횟수가 1회 차감됩니다.\n      "),e("br"),t._v(" "),e("div",{staticClass:"mt-8 p-6 sm:hidden block h-[31rem] bg-[#f9f9f9] rounded-xl border border-[#ccc] text-left overflow-scroll"},[t._v("\n        ▶ 다운로드가 어려우신 경우\n        "),e("br"),t._v(" "),e("span",{staticClass:"text-[#ff0000]"},[t._v("갤럭시")]),t._v("는 "),e("span",{staticClass:"text-[#ff0000]"},[t._v("크롬")]),t._v(" 브라우저로 "),e("span",{staticClass:"text-[#ff0000]"},[t._v("아이폰")]),t._v("은 "),e("span",{staticClass:"text-[#ff0000]"},[t._v("사파리")]),t._v(" 브라우저로 다운로드해 주세요.\n        "),t._v(" "),e("br"),e("br"),t._v(" "),t._v("\n        ▶ "),e("span",{staticClass:"text-[#ff0000]"},[t._v("아이폰")]),t._v(" 다운로드 안내\n        "),e("br"),t._v("\n        * 퍼센티지가 100%가 된 이후 브라우저 자체 다운로드 안내 팝업이 나와요. 팝업에서 다운로드를 눌러주시면 됩니다.\n        "),e("br"),t._v("\n        * "),e("span",{staticClass:"text-[#ff0000]"},[t._v("다운로드한 이미지")]),t._v("는 사전에 설정하신 다운로드 경로(iPhone 또는 iCloud)에 저장되며 "),e("span",{staticClass:"text-[#ff0000]"},[t._v("'파일'앱 - 다운로드 폴더")]),t._v("에서 확인할 수 있습니다.\n        "),e("br"),e("br"),t._v("\n        ▶ "),e("span",{staticClass:"text-[#ff0000]"},[t._v("갤럭시")]),t._v(" 다운로드 안내\n        "),e("br"),t._v("\n        * 퍼센티지가 100%가 된 이후 브라우저 자체 다운로드 안내 팝업이 나와요. 직접 경로 지정 후 원하시는 위치에 다운로드할 수 있습니다.\n        "),e("br"),t._v("\n        * "),e("span",{staticClass:"text-[#ff0000]"},[t._v("다운로드한 이미지")]),t._v("는 "),e("span",{staticClass:"text-[#ff0000]"},[t._v("갤러리")]),t._v("에서 확인할 수 있습니다.\n        "),e("br"),e("br")])]),t._v(" "),e("div",{staticClass:"flex w-full"},[e("button",{staticClass:"modalbtn-l",on:{click:t.close}},[t._v("\n        닫기\n      ")]),t._v(" "),e("button",{staticClass:"modalbtn-r",on:{click:t.downloadImage}},[t._v("\n        다운로드\n      ")])])])])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Popup:n(54).default})}}]);